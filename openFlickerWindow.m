function [monitor imgBG img BGColor] = openFlickerWindow(numOfCB, screenNum)
% CB: textures, positions
% glow: textures, positions

% black
BGColor = [0 0 0];

monitor = Screen('OpenWindow', screenNum);

% import image
img11 = './stimuliLetter/A.png';	img12 = './stimuliLetter/B.png';	img13 = './stimuliLetter/C.png';
img14 = './stimuliLetter/D.png';	img15 = './stimuliLetter/E.png';	img16 = './stimuliLetter/F.png';

img21 = './stimuliLetter/G.png';	img22 = './stimuliLetter/H.png';	img23 = './stimuliLetter/I.png';
img24 = './stimuliLetter/J.png';	img25 = './stimuliLetter/K.png';	img26 = './stimuliLetter/L.png';

img31 = './stimuliLetter/M.png';	img32 = './stimuliLetter/N.png';	img33 = './stimuliLetter/O.png';
img34 = './stimuliLetter/P.png';	img35 = './stimuliLetter/Q.png';	img36 = './stimuliLetter/R.png';

img41 = './stimuliLetter/S.png';	img42 = './stimuliLetter/T.png';	img43 = './stimuliLetter/U.png';
img44 = './stimuliLetter/V.png';	img45 = './stimuliLetter/W.png';	img46 = './stimuliLetter/X.png';

img51 = './stimuliLetter/Y.png';	img52 = './stimuliLetter/Z.png';	img53 = './stimuliLetter/0.png';
img54 = './stimuliLetter/1.png';	img55 = './stimuliLetter/2.png';	img56 = './stimuliLetter/3.png';	

img61 = './stimuliLetter/4.png';	img62 = './stimuliLetter/5.png';	img63 = './stimuliLetter/6.png';
img64 = './stimuliLetter/7.png';	img65 = './stimuliLetter/8.png';	img66 = './stimuliLetter/9.png';

imgBlack = './stimuliLetter/black.png';		imgWhite = './stimuliLetter/white.png';

% read image
read11 = imread(img11);	read12 = imread(img12);	read13 = imread(img13);	
read14 = imread(img14);	read15 = imread(img15);	read16 = imread(img16);

read21 = imread(img21);	read22 = imread(img22);	read23 = imread(img23);
read24 = imread(img24);	read25 = imread(img25);	read26 = imread(img26);

read31 = imread(img31);	read32 = imread(img32);	read33 = imread(img33);
read34 = imread(img34);	read35 = imread(img35);	read36 = imread(img36);

read41 = imread(img41);	read42 = imread(img42);	read43 = imread(img43);
read44 = imread(img44);	read45 = imread(img45);	read46 = imread(img46);

read51 = imread(img51);	read52 = imread(img52);	read53 = imread(img53);
read54 = imread(img54);	read55 = imread(img55);	read56 = imread(img56);

read61 = imread(img61);	read62 = imread(img62);	read63 = imread(img63);
read64 = imread(img64);	read65 = imread(img65);	read66 = imread(img66);

readBlack = imread(imgBlack);		readWhite = imread(imgWhite);

% get info
readInfo11 = imfinfo(img11);	readInfo12 = imfinfo(img12);	readInfo13 = imfinfo(img13);	
readInfo14 = imfinfo(img14);	readInfo15 = imfinfo(img15);	readInfo16 = imfinfo(img16);

readInfo21 = imfinfo(img21);	readInfo22 = imfinfo(img22);	readInfo23 = imfinfo(img23);
readInfo24 = imfinfo(img24);	readInfo25 = imfinfo(img25);	readInfo26 = imfinfo(img26);

readInfo31 = imfinfo(img31);	readInfo32 = imfinfo(img32);	readInfo33 = imfinfo(img33);
readInfo34 = imfinfo(img34);	readInfo35 = imfinfo(img35);	readInfo36 = imfinfo(img36);

readInfo41 = imfinfo(img41);	readInfo42 = imfinfo(img42);	readInfo43 = imfinfo(img43);
readInfo44 = imfinfo(img44);	readInfo45 = imfinfo(img45);	readInfo46 = imfinfo(img46);

readInfo51 = imfinfo(img51);	readInfo52 = imfinfo(img52);	readInfo53 = imfinfo(img53);
readInfo54 = imfinfo(img54);	readInfo55 = imfinfo(img55);	readInfo56 = imfinfo(img56);

readInfo61 = imfinfo(img61);	readInfo62 = imfinfo(img62);	readInfo63 = imfinfo(img63);
readInfo64 = imfinfo(img64);	readInfo65 = imfinfo(img65);	readInfo66 = imfinfo(img66);

readInfoBlack = imfinfo(imgBlack);		readInfoWhite = imfinfo(imgWhite);

% make texture
makeTexture11 = Screen('MakeTexture', monitor,read11);	makeTexture12 = Screen('MakeTexture', monitor,read12);	
makeTexture13 = Screen('MakeTexture', monitor,read13);	makeTexture14 = Screen('MakeTexture', monitor,read14);	
makeTexture15 = Screen('MakeTexture', monitor,read15);	makeTexture16 = Screen('MakeTexture', monitor,read16);

makeTexture21 = Screen('MakeTexture', monitor,read21);	makeTexture22 = Screen('MakeTexture', monitor,read22);	
makeTexture23 = Screen('MakeTexture', monitor,read23);	makeTexture24 = Screen('MakeTexture', monitor,read24);	
makeTexture25 = Screen('MakeTexture', monitor,read25);	makeTexture26 = Screen('MakeTexture', monitor,read26);

makeTexture31 = Screen('MakeTexture', monitor,read31);	makeTexture32 = Screen('MakeTexture', monitor,read32);	
makeTexture33 = Screen('MakeTexture', monitor,read33);	makeTexture34 = Screen('MakeTexture', monitor,read34);	
makeTexture35 = Screen('MakeTexture', monitor,read35);	makeTexture36 = Screen('MakeTexture', monitor,read36);

makeTexture41 = Screen('MakeTexture', monitor,read41);	makeTexture42 = Screen('MakeTexture', monitor,read42);	
makeTexture43 = Screen('MakeTexture', monitor,read43);	makeTexture44 = Screen('MakeTexture', monitor,read44);	
makeTexture45 = Screen('MakeTexture', monitor,read45);	makeTexture46 = Screen('MakeTexture', monitor,read46);

makeTexture51 = Screen('MakeTexture', monitor,read51);	makeTexture52 = Screen('MakeTexture', monitor,read52);	
makeTexture53 = Screen('MakeTexture', monitor,read53);	makeTexture54 = Screen('MakeTexture', monitor,read54);	
makeTexture55 = Screen('MakeTexture', monitor,read55);	makeTexture56 = Screen('MakeTexture', monitor,read56);

makeTexture61 = Screen('MakeTexture', monitor,read61);	makeTexture62 = Screen('MakeTexture', monitor,read62);	
makeTexture63 = Screen('MakeTexture', monitor,read63);	makeTexture64 = Screen('MakeTexture', monitor,read64);	
makeTexture65 = Screen('MakeTexture', monitor,read65);	makeTexture66 = Screen('MakeTexture', monitor,read66);

makeTextureBlack = Screen('MakeTexture', monitor,readBlack);	makeTextureWhite = Screen('MakeTexture', monitor,readWhite);

% set value of image
img.filesize = [readInfo11.FileSize readInfoWhite.FileSize readInfo12.FileSize ...
    readInfoWhite.FileSize readInfo13.FileSize readInfoWhite.FileSize ...
    readInfo14.FileSize readInfoWhite.FileSize readInfo15.FileSize ...
    readInfoWhite.FileSize readInfo16.FileSize readInfoWhite.FileSize ...
	readInfo21.FileSize readInfoWhite.FileSize readInfo22.FileSize ...
    readInfoWhite.FileSize readInfo23.FileSize readInfoWhite.FileSize ...
    readInfo24.FileSize readInfoWhite.FileSize readInfo25.FileSize ...
    readInfoWhite.FileSize readInfo26.FileSize readInfoWhite.FileSize ...
	readInfo31.FileSize readInfoWhite.FileSize readInfo32.FileSize ...
    readInfoWhite.FileSize readInfo33.FileSize readInfoWhite.FileSize ...
    readInfo34.FileSize readInfoWhite.FileSize readInfo35.FileSize ...
    readInfoWhite.FileSize readInfo36.FileSize readInfoWhite.FileSize ...
	readInfo41.FileSize readInfoWhite.FileSize readInfo42.FileSize ...
    readInfoWhite.FileSize readInfo43.FileSize readInfoWhite.FileSize ...
    readInfo44.FileSize readInfoWhite.FileSize readInfo45.FileSize ...
    readInfoWhite.FileSize readInfo46.FileSize readInfoWhite.FileSize ...
	readInfo51.FileSize readInfoWhite.FileSize readInfo52.FileSize ...
    readInfoWhite.FileSize readInfo53.FileSize readInfoWhite.FileSize ...
    readInfo54.FileSize readInfoWhite.FileSize readInfo55.FileSize ...
    readInfoWhite.FileSize readInfo56.FileSize readInfoWhite.FileSize ...
	readInfo61.FileSize readInfoWhite.FileSize readInfo62.FileSize ...
    readInfoWhite.FileSize readInfo63.FileSize readInfoWhite.FileSize ...
    readInfo64.FileSize readInfoWhite.FileSize readInfo65.FileSize ...
    readInfoWhite.FileSize readInfo66.FileSize readInfoWhite.FileSize];
imgBG.filesize = [readInfoBlack.FileSize readInfoWhite.FileSize];

img.textures = [makeTexture11 makeTextureWhite makeTexture12 ...
    makeTextureWhite makeTexture13 makeTextureWhite ...
    makeTexture14 makeTextureWhite makeTexture15 ...
    makeTextureWhite makeTexture16 makeTextureWhite ...
	makeTexture21 makeTextureWhite makeTexture22 ...
    makeTextureWhite makeTexture23 makeTextureWhite ...
    makeTexture24 makeTextureWhite makeTexture25 ...
    makeTextureWhite makeTexture26 makeTextureWhite ...
	makeTexture31 makeTextureWhite makeTexture32 ...
    makeTextureWhite makeTexture33 makeTextureWhite ...
    makeTexture34 makeTextureWhite makeTexture35 ...
    makeTextureWhite makeTexture36 makeTextureWhite ...
	makeTexture41 makeTextureWhite makeTexture42 ...
    makeTextureWhite makeTexture43 makeTextureWhite ...
    makeTexture44 makeTextureWhite makeTexture45 ...
    makeTextureWhite makeTexture46 makeTextureWhite ...
	makeTexture51 makeTextureWhite makeTexture52 ...
    makeTextureWhite makeTexture53 makeTextureWhite ...
    makeTexture54 makeTextureWhite makeTexture55 ...
    makeTextureWhite makeTexture56 makeTextureWhite ...
	makeTexture61 makeTextureWhite makeTexture62 ...
    makeTextureWhite makeTexture63 makeTextureWhite ...
    makeTexture64 makeTextureWhite makeTexture65 ...
    makeTextureWhite makeTexture66 makeTextureWhite];
imgBG.textures = [makeTextureBlack makeTextureWhite];

img.length = length(img.textures);
imgBG.length = length(imgBG.textures);

imgCorner = floor([-abs([readInfo11.Width readInfo11.Height]) abs([readInfo11.Width readInfo11.Height])]/2);
imgBGCorner = floor([-abs([readInfoBlack.Width readInfoBlack.Height]) abs([readInfoBlack.Width readInfoBlack.Height])]/2);

%if numOfCB == 10
%    CB1File = './figure/checkerboard192a.bmp';
%    CB2File = './figure/checkerboard192b.bmp';
%    %CB1File = './figure/white_192.bmp';
%    %CB2File = './figure/black_192.bmp';
%    %CB1File = './figure/black_192.bmp';
%    %CB2File = './figure/white_192.bmp';
%    glowFile = './figure/glow192.bmp';
%    
%else
    %CB1File = './figure/checkerboard_2cpd_a.bmp';
    %CB2File = './figure/checkerboard_2cpd_b.bmp';
%    CB1File = './figure/white_2cpd.bmp';
%    CB2File = './figure/black_2cpd.bmp';
%    glowFile = './figure/glow.bmp';
    %ECFile = './figure/eyecatcher192.bmp';
%end
%ECFile = './figure/eyecatcher.bmp';

%gray
%BGColor = [85 85 102];
%white
%BGColor = [255 255 255];
%black
%BGColor = [0 0 0];

%monitor = Screen('OpenWindow', screenNum);

%CB1 = imread(CB1File);
%CB2 = imread(CB2File);
%CBInfo = imfinfo(CB1File);

%CB1 = Screen('MakeTexture', monitor, CB1);
%CB2 = Screen('MakeTexture', monitor, CB2);
%CB.textures = [CB1 CB2];
%CBCorner = floor([-abs([CBInfo.Width CBInfo.Height]) abs([CBInfo.Width CBInfo.Height])]/2);

%EC = imread(ECFile);
%ECInfo = imfinfo(ECFile);

%EC.texture = Screen('MakeTexture', monitor, EC);
%ECCorner = floor([-abs([ECInfo.Width ECInfo.Height]) abs([ECInfo.Width ECInfo.Height])]/2);

%glow = imread(glowFile);
%glowInfo = imfinfo(glowFile);

%glow.texture = Screen('MakeTexture', monitor, glow);
%glowCorner = floor([-abs([glowInfo.Width glowInfo.Height]) abs([glowInfo.Width glowInfo.Height])]/2);


%tone2 = [880 1318.51]; % Hz
%tone4 = [783.99 987.77 1174.66 1567.98]; % Hz
%tone6 = [587.33 783.99 987.77 1174.66 1567.98 1975.53]; %Hz
%tone8 = [493.88 587.33 783.99 987.77 1174.66 1567.98 1975.53 2349.32]; % Hz
%tone10 = [392.00 493.88 587.33 783.99 987.77 1174.66 1567.98 1975.53 2349.32 3135.96]; % Hz
%soundLength = .125;


HideCursor;
priorityLevel = MaxPriority(monitor);
Priority(priorityLevel);
Screen('FillRect', monitor, BGColor);
Screen('TextColor', monitor, 255);
Screen('Flip', monitor)


switch numOfCB
  case 1
    img.positions =  repmat([...
      960 600;...
			],1,2)+ repmat(imgCorner, 1, 1);
   %EC.positions = CB.positions;
   %soundwave = sin(sort(tone2(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
	case 2
		img.positions = repmat([...
      700 300;...
			1200 300; ...
			...
			700 800;...
			1200 800 ...
			], 1, 2)...
			+ repmat(imgCorner, 4, 1);
    
    %EC.positions = repmat(CB.positions(:,1:2) + repmat([120 300],2,1),1,2) + repmat(ECCorner, 2, 1);
      
		
		%soundwave = sin(sort(tone2(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
	case 3
		img.positions = repmat([...
            600 200;...
            1000 200;...
			1400 200;...
			...
			600 550;...
			1000 550;...
			1400 550;...
			...
			600 900;...
			1000 900;...
			1400 900 ...
			], 1, 2)...
			+ repmat(imgCorner, 9, 1);
		%EC.positions = repmat(CB.positions(:,1:2) + repmat([120 300],4,1),1,2) + repmat(ECCorner, 4, 1);
		%soundwave = sin(sort(tone4(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
	case 4
		img.positions = repmat([...
			550 100;...
			850 100;...
			1150 100;...
			1450 100;...
			...
			550 350;...
			850 350;...
			1150 350;...
			1450 350;...
			...
			550 600;...
			850 600;...
			1150 600;...
			1450 600;...
			...
			550 850;...
			850 850;...
			1150 850;...
			1450 850 ...
			], 1, 2)...
			+ repmat(imgCorner, 16, 1);
    
		%EC.positions = repmat(CB.positions(:,1:2) + repmat([120 300],6,1),1,2) + repmat(ECCorner, 6, 1);
		%soundwave = sin(sort(tone6(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
		
	case 5
		img.positions = repmat([...
			500 100;...
			750 100;...
			1000 100;...
			1250 100;...
			1500 100;...
      ...		
      		500 300;...
			750 300;...
			1000 300;...
			1250 300;...
			1500 300;...
      ...	
      		500 500;...
			750 500;...
			1000 500;...
			1250 500;...
			1500 500;...
      ...	
      		500 700;...
			750 700;...
			1000 700;...
			1250 700;...
			1500 700;...
      ...	
			500 900;...
			750 900;...
			1000 900;...
			1250 900;...
			1500 900;...
			], 1, 2)...
			+ repmat(imgCorner, 25, 1);
			
			
			
    %  EC.positions = repmat([...
	%		382 504;...
	%		766 504;...
	%		1150 504;...
	%		1534 504;...
	%		...
	%		382 888;...
	%		766 888;...
	%		1150 888;...
	%		1534 888;...
	%		], 1, 2)...
	%		+ repmat(ECCorner, 8, 1);
    
    %soundwave = sin(sort(tone8(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
	
	case 6
		img.positions = repmat([...
			400 50;...
			650 50;...
			900 50;...
			1150 50;...
			1400 50;...
			1650 50;...
			...
			400 225;...
			650 225;...
			900 225;...
			1150 225;...
			1400 225;...
			1650 225;...
			...
			400 400;...
			650 400;...
			900 400;...
			1150 400;...
			1400 400;...
			1650 400;...
			...
			400 575;...
			650 575;...
			900 575;...
			1150 575;...
			1400 575;...
			1650 575;...
			...
			400 750;...
			650 750;...
			900 750;...
			1150 750;...
			1400 750;...
			1650 750;...
			...
			400 925;...
			650 925;...
			900 925;...
			1150 925;...
			1400 925;...
			1650 925;...
			], 1, 2)...
			+ repmat(imgCorner, 36, 1);
      
    %EC.positions = repmat([...
	%		192 504;...
	%		576 504;...
	%		960 504;...
	%		1344 504;...
	%		1728 504;...
	%		...
	%		192 888;...
	%		576 888;...
	%		960 888;...
	%		1344 888;...
	%		1728 888;...
	%		], 1, 2)...
	%		+ repmat(ECCorner, 10, 1);
		
		%soundwave = sin(sort(tone10(:))*(0:(round(8192*soundLength) - 1))*2*pi/8192);
end

%if numOfCB ~=0
%  glow.positions = img.positions + repmat((glowCorner - imgCorner), numOfCB, 1);
%end
end
